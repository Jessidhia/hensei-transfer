javascript:!function(){var n,a;if(n=new XMLHttpRequest,a=new Date().getTime(),n.open("GET","https://raw.githubusercontent.com/Vazkii/hensei-transfer/main/version?_anti_cache_measures="+a,!1),n.send(),8!=n.response.trim()&&confirm("hensei-transfer has received an update. Please re-download the bookmarklet to ensure it's compatible with the latest changes, or click Cancel to proceed anyway.")){window.open("https://github.com/Vazkii/hensei-transfer","_blank");return}window.location.href.includes("game.granbluefantasy.jp")?function n(){var a,e,r,s,t,u,o,m;function l(n,a){let e=[210,220,230,240];var r=[];for(k in n){var s={},t=n[k],u=t.master,o=t.param;if(u&&o){s.name=u.name,s.id=u.id;var m=parseInt(o.evolution);if(s.uncap=m,m>5){var l=1,c=parseInt(o.level);for(k2 in e)if(c>e[k2])l++;else break;s.transcend=l}a&&o.id==a&&(s.qs=!0),r.push(s)}}return r}a=Game,e=function(n){let a={Attack:"atk",Defense:"def",Special:"spec","C.A.":"ca",Healing:"heal","Skill DMG":"skill"},e=["0mlb","1mlb","2mlb","mlb","flb","ulb","trans"],r={"Colossus Omega":4,"Leviathan Omega":4,"Yggdrasil Omega":4,"Tiamat Omega":4,"Luminiera Omega":4,"Celeste Omega":4,Agni:5,Varuna:5,Titan:5,Zephyrus:5,Zeus:5,Hades:5},s={auto:["1240","758"],skill:["1241","759"],ougi:["1242","760"],cb:["1243","761"],stamina:["502-507","1213-1218","727-736"],enmity:["130-135","71-76","737-746"],tirium:["1260-1265","1266-1271"],progression:["1199-1204","1205-1210"],celere:["322-327","1310-1315"],majesty:["764-769","1731-1735","948"],glory:["1171-1176","1736-1741"],freyr:"1723",apple:"1724",depravity:"1725",echo:"1726",atk:"697-706",ma:"707-716",hp:"717-726",crit:"747-756",cap:"1807",healing:"1808",seraphic:"1809",cbgain:"1810",def:"1446",fire:"1447",water:"1448",earth:"1449",wind:"1450",light:"1451",dark:"1452",primal:"1228-1233",magna:"1234-1239"};var t,u,o=["Fire","Water","Earth","Wind","Light","Dark"];function m(n){var a=n.uncap;return 6==a?"D":5==a?"C":null}function l(a,e){if(!a)return"";for(var r in n="\n|"+e+"=",a.keys){var s=a.keys[r];0!=r&&(n+=","),n+=c(parseInt(s))}return n}function c(n){for(var a in s){var e=s[a];if("string"==typeof e&&_(e,n))return a;for(k in e)if(_(e[k],n))return a}return""}function _(n,a){if(n.includes("-")){var e=n.split("-"),r=parseInt(e[0]),s=parseInt(e[1]);return a>=r&&a<=s}return parseInt(n)==a}function f(n){var a=e[n.uncap];return n.transcend&&(a+=n.transcend),a}function p(n,a){var e,s=(e=n,e.transcend?5==e.transcend?"D":"C":e.name in r?e.uncap>=r[e.name]?"B":"A":null);return s?"|art"+a+"="+s:""}t=n=function n(e){var r=JSON.parse(e);if("en"!=r.lang)return"Please change your game to English before exporting.";var e="=== "+r.name+" ===";return e+="\n{{TeamSpread",e+="\n|team="+function n(a){var e="{{Team";for(var r in e+="\n|class="+a.class.toLowerCase(),a.characters){var s=a.characters[r],t=parseInt(r)+1;e+="\n|char"+t+"="+s.name,s.transcend&&(e+="|trans"+t+"="+s.transcend);var u=m(s);u&&(e+="|art"+t+"="+u)}for(var r in a.subskills){var o=a.subskills[r],t=parseInt(r)+1;e+="\n|skill"+t+"="+o}return e+="\n|main="+a.summons[0].name,e+="\n|support="+a.friend_summon,e+="\n}}"}(r),e+="\n|weapons="+function n(e){var r="{{WeaponGridSkills",s=null,t=null,u=null;for(var m in e.weapons){var c=e.weapons[m],_=0==m?"mh":"wp"+m,f=0==m?"umh":"u"+m;r+="\n|"+_+"="+c.name,"attr"in c&&(r+=" ("+o[c.attr]+")"),r+="|"+f+"="+c.uncap,c.awakening&&(r+="|"+(0==m?"awkmh":"awk"+m)+"="+a[c.awakening.type]),c.keys&&(c.name.includes("Ultima")?u=c:c.name.includes("iation")?s=c:c.name.includes("Draconic")&&(t=c))}return r+=l(s,"opus"),r+=l(t,"draconic"),r+=l(u,"ultima"),r+="\n}}"}(r),e+="\n|summons="+function n(a){var e="{{SummonGrid",r=-1;for(var s in a.summons){var t=a.summons[s],u=0==s?"main":"s"+s,o=0==s?"umain":"u"+s,m=0==s?"main":s;e+="\n|"+u+"="+t.name,e+="|"+o+"="+f(t),e+=p(t,m),t.qs&&(r=s)}for(var s in a.sub_summons){var t=a.sub_summons[s],l=parseInt(s)+1,u="sub"+l,o="usub"+l;e+="\n|"+u+"="+t.name,e+="|"+o+"="+f(t),e+=p(t,u)}return r>-1&&(e+="\n|quick="+(0==r?"main":r)),e+"\n}}"}(r),e+="\n}}"}(n),u=$("<textarea>"),$("body").append(u),u.text(t),u.select(),document.execCommand("copy"),u.remove(),alert("Copied team data to clipboard!")},s=(r=a.view.deck_model.attributes.deck).name,t=a.lang,u={},o=r.pc,u.lang=t,u.name=s,u.class=o.job.master.name,u.extra=o.isExtraDeck,u.friend_summon=o.damage_info.summon_name,(m=o.familiar_id)||(m=o.shield_id),m&&(u.accessory=m),u.subskills=function n(a){var e=[];for(var r in a){var s=a[r];e.push(s.name)}return e}(o.set_action),u.characters=function n(a){var e=[];for(k in a){var r={},s=a[k],t=s.master,u=s.param;if(t&&u){r.name=t.name,r.id=t.id,r.uncap=parseInt(u.evolution),u.has_npcaugment_constant&&(r.ringed=!0);var o=parseInt(u.phase);o>0&&(r.transcend=o),e.push(r)}}return e}(r.npc),u.weapons=function n(a){let e=[40,60,80,100,150],r=[[13],[3,13,19,27],[3,13,27]],s=[13,17,19];var t=[];for(k in a){var u={},o=a[k],m=o.master,l=o.param;if(m&&l){var c=parseInt(m.series_id);u.name=m.name;var _=m.id;if(s.includes(c)){var f=parseInt(m.attribute)-1;u.attr=f,_=`${parseInt(_)-100*f}`}u.id=_;var p=0,v=parseInt(l.level);for(k2 in e)if(v>e[k2])p++;else break;u.uncap=p;var d=l.arousal;if(d.is_arousal_weapon){var h={};h.type=d.form_name,h.lvl=d.level,u.awakening=h}var g=l.augment_skill_info;if(g.length>0){var b=g[0],w=[];for(k2 in b){var y={},C=b[k2];y.id=`${C.skill_id}`,y.val=C.show_value,w.push(y)}u.ax=w}var x=[];for(i in r)if(r[i].includes(c)){var D=`skill${parseInt(i)+1}`;D in o&&x.push(o[D].id)}x.length>0&&(u.keys=x),t.push(u)}}return t}(o.weapons),u.summons=l(o.summons,o.quick_user_summon_id),u.sub_summons=l(o.sub_summons,0),e(JSON.stringify(u))}():alert("Can only be used in game.granbluefantasy.jp")}();