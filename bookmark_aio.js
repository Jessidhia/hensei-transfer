javascript:!function(){var e,n;if(e=new XMLHttpRequest,n=new Date().getTime(),e.open("GET","https://raw.githubusercontent.com/Vazkii/hensei-transfer/main/version?_anti_cache_measures="+n,!1),e.send(),18!=e.response.trim()&&confirm("hensei-transfer has received an update. Please re-download the bookmarklet to ensure it's compatible with the latest changes, or click Cancel to proceed anyway.")){window.open("https://github.com/Vazkii/hensei-transfer","_blank");return}window.location.href.includes("app.granblue.team")?function e(){function n(e,n,s,o){var u=0;for(k in s){var c=s[k],l=c.name,p=c.id,d=c.uncap,m=t(e,"summons",{query:l},function(e){return e.granblue_id==p});if(m.length>0){var f=0==o&&0==u,v=u-1+o,g=r(e,"summons",v,{summon:{summon_id:m,party_id:e.party,position:v,main:f,friend:!1,uncap_level:d}}).grid_summon.id;"transcend"in c&&a(e,g,6,c.transcend),"qs"in c&&c.qs&&_(e,"summons/update_quick_summon",{summon:{id:g,quick_summon:!0}}),u++}}if(n){var m=t(e,"summons",{query:n},function(a){return a.name[e.lang]==n});if(m.length>0){var h=r(e,"summons",v,{summon:{summon_id:m,party_id:e.party,position:6,main:!1,friend:!0,uncap_level:0}}),y=h.grid_summon.id,b=h.grid_summon.object.uncap,w=b.xlb?6:b.ulb?5:b.flb?4:3;a(e,y,w,6==w?5:0)}}}function a(e,n,a,r){_(e,"summons/update_uncap",{summon:{id:n,uncap_level:a,transcendence_step:r}})}function r(e,n,a,r){var t=_(e,n,r);return"conflicts"in t&&(t=_(e,`${n}/resolve`,{resolve:{conflicting:[t.conflicts[0].id],incoming:t.incoming.id,position:a}})),t}function t(e,n,a,r){return s(_(e,`search/${n}`,{search:a}).results,r)}function s(e,n){for(k in e){var a=e[k];if(n(a))return a.id}return null==e||void 0==e||0==e.length?"":e[0].id}function o(e,n){return c(e,"GET",n,void 0,!1)}function u(e,n,a,r,t,s){return c(e,"PUT",`${n}/${a}/${r}`,t,s)}function _(e,n,a){return c(e,"POST",n,a,!1)}function c(e,n,a,r,t){var s=new XMLHttpRequest,o=`https://hensei-api-production-66fb.up.railway.app/api/v1/${a}`;return(s.open(n,o,t),s.setRequestHeader("content-type","application/json"),s.setRequestHeader("authorization",`Bearer ${e.auth}`),void 0!=r?s.send(JSON.stringify(r)):s.send(),t)?"":JSON.parse(s.responseText)}!function e(a){var c=a.props.pageProps.context;if(null==c){alert("Please refresh the page to load important data, then try again.");return}if(void 0==c.jobs||null==c.jobs){alert("Some data needed to create a team is missing, please open a team that already exists and press F5, and then run the script again. This will not overwrite your team. You can offset this by bookmarking the New team page and running the script from there.");return}var l=function e(){var n=document.cookie.match(RegExp("token\u002522\u00253A\u002522(.+?)\u002522"));if(n)return n[1]}();if(!l){alert("This import script only works for logged-in users, please log-in or create an account.");return}var p={jobs:c.jobs,auth:l},d=prompt("Paste your Export here");if(d&&0!=d.length){var m=JSON.parse(d);document.querySelectorAll("*").forEach(e=>e.style.cursor="wait");var f=document.querySelector('span[class^="Button_text__"]');f&&(f.innerHTML='<span style="color:cyan;font-size:22px;">Loading your team... this may take a bit</span>'),setTimeout(function(){var e,a,c,l,d,f,v=(e=p,a=_(e,"parties",{}),{id:a.party.id,redirect:`/p/${a.party.shortcode}`});p.party=v.id,p.lang=m.lang,l=p,d=m.name,f=m.extra,u(l,"parties",l.party,"",{party:{name:d,extra:f}},!0),function e(n,a,r,_){var c=s(n.jobs,function(e){return e.name[n.lang]==a});if(c.length>0){if(u(n,"parties",n.party,"jobs",{party:{job_id:c}},!1),r.length>0){var l={},p=0;for(k in r){var d=r[k],m=t(n,"job_skills",{query:d,job:c,locale:n.lang},function(e){return e.name[n.lang]==d});m.length>0&&(l[`skill${++p}_id`]=m)}var f=[];for(k in l){var v={};v[k]=l[k],"code"in u(n,"parties",n.party,"job_skills",{party:v},!1)&&f.push(v)}for(k in f)u(n,"parties",n.party,"job_skills",{party:f[k]},!0)}if(_){var g=o(n,`jobs/${c}/accessories`),h=s(g,function(e){return e.granblue_id==_});u(n,"parties",n.party,"",{party:{accessory_id:h}})}}}(p,m.class,m.subskills,"accessory"in m?m.accessory:""),function e(n,a){var s=0;for(k in a){var o=a[k],_=o.name,c=o.id,l=o.uncap,p=t(n,"characters",{query:_},function(e){return e.granblue_id==c});if(p.length>0){var d=r(n,"characters",s,{character:{character_id:p,party_id:n.party,position:s,uncap_level:l}}).id;"ringed"in o&&o.ringed&&u(n,"grid_characters",d,"",{character:{perpetuity:!0}},!0),"transcend"in o&&u(n,"grid_characters",d,"",{character:{uncap_level:6,transcendence_step:o.transcend}},!0),s++}}}(p,m.characters),function e(n,a){let _=[0,2,3,4,1,6,5],c={k13001:["1240","2204"],k13002:["1241","2205"],k13003:["1242","2206"],k13004:["1243","2207"],k14014:"1723",k14015:"1724",k14016:"1725",k14017:"1726",k10001:"697-706",k10002:"707-716",k10003:"717-726",k10004:"727-736",k10005:"737-746",k10006:"747-756",k11001:"758",k11002:"759",k11003:"760",k11004:"761",k17001:"1807",k17002:"1808",k17003:"1809",k17004:"1810",k15001:"1446",k15002:"1447",k15003:"1448",k15004:"1449",k15005:"1450",k15006:"1451",k15007:"1452",k16001:"1228-1233",k16002:"1234-1239",k14001:["502-507","1213-1218"],k14002:["130-135","71-76"],k14003:["1260-1265","1266-1271"],k14004:["1199-1204","1205-1210"],k14011:["322-327","1310-1315"],k14012:["764-769","1731-1735","948"],k14013:["1171-1176","1736-1741"],k15008:"2043-2048",k15009:"2049-2055",k14005:"2212-2223",k14006:"2224-2235",k14007:"2236-2247"},l={ax1588:2,ax1588:7,ax1589:0,ax1590:1,ax1591:3,ax1592:4,ax1593:9,ax1594:13,ax1595:10,ax1596:5,ax1597:6,ax1599:8,ax1600:12,ax1601:11,ax1719:15,ax1720:16,ax1721:17,ax1722:14};var p=0;for(k in a){var d=a[k],m=d.name,f=d.id,v=d.uncap,g=t(n,"weapons",{query:m},function(e){return e.granblue_id==f});if(g.length>0){var h=0==p,y=p-1,b=r(n,"weapons",y,{weapon:{weapon_id:g,party_id:n.party,position:y,mainhand:h,uncap_level:v}}),w=b.grid_weapon.id;if("attr"in d&&u(n,"grid_weapons",w,"",{weapon:{element:_[d.attr+1]}},!0),"transcend"in d&&u(n,"grid_weapons",w,"",{weapon:{uncap_level:6,transcendence_step:d.transcend}},!0),"awakening"in d){for(var x=d.awakening,j=x.type,q=x.lvl,T=b.grid_weapon.object.awakenings,P=null,E=0;E<T.length;E++){var S=T[E];if(S.name[n.lang]==j){P=S;break}}P&&u(n,"grid_weapons",w,"",{weapon:{awakening_id:P.id,awakening_level:q}},!0)}if("keys"in d){var z=d.keys,C=b.grid_weapon.object.series;for(k2 in z){var H=z[k2],A=o(n,`weapon_keys?series=${C}&slot=${k2}`),B=s(A,function(e){var n=`k${e.granblue_id}`;if(n in c){var a=c[n];function r(e){if(e.includes("-")){var n=e.split("-"),a=parseInt(n[0]),r=parseInt(n[1]);return H>=a&&H<=r}return parseInt(e)==H}if("string"==typeof a)return r(a);for(G in a)if(r(a[G]))return!0}return!1}),G=parseInt(k2)+1,L={};L[`weapon_key${G}_id`]=B,u(n,"grid_weapons",w,"",{weapon:L},!0)}}if("ax"in d){var O=d.ax,R={};for(k2 in O){var V=O[k2],D=l["ax"+V.id],F=parseInt(k2)+1;R[`ax_modifier${F}`]=D,R[`ax_strength${F}`]=parseInt(V.val.replace("+","").replace("\u0025",""))}u(n,"grid_weapons",w,"",{weapon:R},!0)}p++}}}(p,m.weapons),n(p,m.friend_summon,m.summons,0),n(p,void 0,m.sub_summons,5);var g=v.redirect;g.length>0&&history.pushState({urlPath:g},"",g),location.reload()},250)}}(__NEXT_DATA__)}():window.location.href.includes("game.granbluefantasy.jp")?function e(){var n,a,r,t,s,o,u,_;function c(e,n){let a=[210,220,230,240];var r=[];for(k in e){var t={},s=e[k],o=s.master,u=s.param;if(o&&u){t.name=o.name,t.id=o.id;var _=parseInt(u.evolution);if(t.uncap=_,_>5){var c=1,l=parseInt(u.level);for(k2 in a)if(l>a[k2])c++;else break;t.transcend=c}n&&u.id==n&&(t.qs=!0),r.push(t)}}return r}n=Game,a=function(e){var n,a;n=e,a=$("<textarea>"),$("body").append(a),a.text(n),a.select(),document.execCommand("copy"),a.remove(),confirm("Copied team data to clipboard! If you press OK, a new tab in app.granblue.team will be open now - click the bookmark again on it and paste your data in there.")&&window.open("https://app.granblue.team","_blank")},t=(r=n.view.deck_model.attributes.deck).name,s=n.lang,o={},u=r.pc,o.lang=s,o.name=t,o.class=u.job.master.name,o.extra=u.isExtraDeck,o.friend_summon=u.damage_info.summon_name,(_=u.familiar_id)||(_=u.shield_id),_&&(o.accessory=_),o.subskills=function e(n){var a=[];for(var r in n){var t=n[r];a.push(t.name)}return a}(u.set_action),o.characters=function e(n){var a=[];for(k in n){var r={},t=n[k],s=t.master,o=t.param;if(s&&o){r.name=s.name,r.id=s.id,r.uncap=parseInt(o.evolution),o.has_npcaugment_constant&&(r.ringed=!0);var u=parseInt(o.phase);u>0&&(r.transcend=u),a.push(r)}}return a}(r.npc),o.weapons=function e(n){let a=[40,60,80,100,150,200],r=[210,220,230,240],t=[[13],[3,13,19,27,40],[3,13,27,40]],s=[13,17,19];var o=[];for(k in n){var u={},_=n[k],c=_.master,l=_.param;if(c&&l){var p=parseInt(c.series_id);u.name=c.name;var d=c.id;if(s.includes(p)){var m=parseInt(c.attribute)-1;u.attr=m,d=`${parseInt(d)-100*m}`}u.id=d;var f=0,v=parseInt(l.level);for(k2 in a)if(v>a[k2])f++;else break;if(u.uncap=f,f>5){var g=1;for(k2 in r)if(v>r[k2])g++;else break;u.transcend=g}var h=l.arousal;if(h.is_arousal_weapon){var y={};y.type=h.form_name,y.lvl=h.level,u.awakening=y}var b=l.augment_skill_info;if(b.length>0){var w=b[0],x=[];for(k2 in w){var j={},q=w[k2];j.id=`${q.skill_id}`,j.val=q.show_value,x.push(j)}u.ax=x}var T=[];for(i in t)if(t[i].includes(p)){var P=`skill${parseInt(i)+1}`;P in _&&T.push(_[P].id)}T.length>0&&(u.keys=T),o.push(u)}}return o}(u.weapons),o.summons=c(u.summons,u.quick_user_summon_id),o.sub_summons=c(u.sub_summons,0),a(JSON.stringify(o))}():alert("Can only be used in game.granbluefantasy.jp or app.granblue.team")}();