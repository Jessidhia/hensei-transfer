javascript:"use strict";(()=>{var E=22;var T="Jessidhia/hensei-transfer";async function k(){let n=new Date().getTime();try{if(await(await fetch(`https://raw.githubusercontent.com/${T}/main/version.json?_=${n}`)).json()>E&&confirm("hensei-transfer has received an update. Please re-download the bookmarklet to ensure it's compatible with the latest changes, or click Cancel to proceed anyway."))return open(`https://github.com/${T}`,"_blank"),!1}catch(e){console.error(e)}return!0}function I(n){let e=document.body.appendChild(document.createElement("textarea"));e.textContent=n,e.select(),document.execCommand("copy"),e.remove()}function x(){return Game}function $({view:{deck_model:{attributes:{deck:{name:n,pc:e,npc:s}}}},lang:a}){return{lang:a,name:n,class:e.job.master.name,extra:e.isExtraDeck,friend_summon:e.damage_info.summon_name,accessory:e.familiar_id||e.shield_id,subskills:H(e.set_action),characters:D(s),weapons:q(e.weapons),summons:W(e.summons,e.quick_user_summon_id),sub_summons:W(e.sub_summons)}}function H(n){return n.map(e=>"name"in e?e.name:null)}function D(n){return Object.values(n).filter(G).map(({master:e,param:s})=>{let a={name:e.name,id:e.id,uncap:parseInt(s.evolution,10)};s.has_npcaugment_constant&&(a.ringed=!0);let r=parseInt(s.phase,10);return r>0&&(a.transcend=r),a})}function q(n){let e=[40,60,80,100,150,200],s=[210,220,230,240],a=[[13],[3,13,19,27,40],[3,13,27,40]],r=[13,17,19];return Object.values(n).filter(G).map(({master:o,param:t,...i})=>{let u=parseInt(o.id,10),c=parseInt(o.series_id,10),b=parseInt(o.attribute,10),d=r.includes(c),w=parseInt(t.level,10),S=e.reduce((l,m)=>w>m?l+1:l,0),p={name:o.name,attr:d?b:void 0,id:d?`${u-(b-1)*100}`:o.id,uncap:S};S>5&&(p.transcend=s.reduce((l,m)=>w>m?l+1:l,1));let{arousal:f}=t;f.is_arousal_weapon&&f.form_name&&(p.awakening={type:f.form_name,lvl:f.level});let v=t.augment_skill_info;if(v.length!=0){let l=v[0];p.ax=l.map(({skill_id:m,show_value:g})=>({id:`${m}`,val:g}))}let _=[];for(let[l,m]of a.entries())if(m.includes(c)){let g=`skill${l+1}`;i[g]&&_.push(i[g].id)}return _.length>0&&(p.keys=_),p})}function W(n,e){let s=[210,220,230,240];return Object.values(n).filter(G).map(({master:a,param:r})=>{let o=parseInt(r.evolution,10),t={name:a.name,id:a.id,uncap:o};if(o>5){let i=parseInt(r.level,10);t.transcend=s.reduce((u,c)=>i>c?u+1:u,1)}return e&&r.id==`${e}`&&(t.qs=!0),t})}function G(n){return n.master!==null&&n.param!==null}function C(n,e){return(Array.isArray(n)?n:[n]).some(a=>{let[r,o]=s(a);return e>=r&&e<=o});function s(a){let r=/^(\d+)(?:-(\d+))?$/.exec(a),o=parseInt(r[1],10);return[o,r[2]?parseInt(r[2],10):o]}}function h(n){return n.lang!="en"?(alert("Please change your game to English before exporting."),null):`{{TeamSpread\n|team=${A(n)}\n|weapons=${J(n)}\n|summons=${M(n)}\n}}`}function A(n){return`{{Team\n|class=${n.class.toLowerCase()}${n.characters.map((e,s)=>{let a=s+1,r=e.transcend?`|trans${a}=${e.transcend}`:"",o=e.uncap==6?"D":e.uncap==5?"C":e.uncap>2?"B":"",t=o?`|art${a}=${o}`:"";return`\n|char${a}=${e.name}${r}${t}`}).join("")}${n.subskills.map((e,s)=>{let a=s+1;return e==null?"":`\n|skill${a}=${e}`}).join("")}\n|main=${n.summons[0]?.name||""}\n|support=${n.friend_summon||""}\n}}`}var U={Attack:"atk",Defense:"def",Special:"spec","C.A.":"ca",Healing:"heal","Skill DMG":"skill"},B=new Set(["Refrain of Blazing Vigor","Judgment of Torrential Tides","Bounty of Gracious Earth","Prayer of Grand Gales","Radiance of Insightful Rebirth","Festering of Mournful Obsequies"]),L={auto:["1240","758","2204","2208"],skill:["1241","759","2205","2209"],ougi:["1242","760","2206","2210"],cb:["1243","761","2207","2211"],stamina:["502-507","1213-1218","727-736"],enmity:["130-135","71-76","737-746"],tirium:["1260-1265","1266-1271"],progression:["1199-1204","1205-1210"],celere:["322-327","1310-1315"],majesty:["764-769","1731-1735","948"],glory:["1171-1176","1736-1741"],freyr:"1723",apple:"1724",depravity:"1725",echo:"1726",extremity:"2212-2223",sagacity:"2224-2235",supremacy:"2236-2247",atk:"697-706",ma:"707-716",hp:"717-726",crit:"747-756",cap:"1807",healing:"1808",seraphic:"1809",cbgain:"1810",def:"1446",fire:"1447",water:"1448",earth:"1449",wind:"1450",light:"1451",dark:"1452",fortitude:"2043-2048",magnitude:"2049-2055",primal:"1228-1233",magna:"1234-1239"},F=["Fire","Water","Earth","Wind","Light","Dark"];function J(n){let e="{{WeaponGridSkills",s,a,r;for(let[o,t]of n.weapons.entries()){let i=o==0,u=i?"mh":"wp"+o,c=i?"umh":"u"+o;e+=`\n|`+u+"="+t.name,t.attr&&(e+=" ("+F[t.attr-1]+")");let b=t.transcend?`t${t.transcend}`:t.uncap;if(e+="|"+c+"="+b,t.awakening){let d=i?"awkmh":"awk"+o;e+="|"+d+"="+U[t.awakening.type]}t.keys&&(t.name.includes("Ultima")?r=t:t.name.includes("iation")?s=t:(t.name.includes("Draconic")||B.has(t.name))&&(a=t))}return e+=y(s,"opus"),e+=y(a,"draconic"),e+=y(r,"ultima"),e+=`\n}}`,e}function y(n,e){if(!n||!n.keys)return"";return`\n|${e}=${n.keys.filter(a).map(r=>s(parseInt(r,10))).join(",")}`;function s(r){return Object.entries(L).find(([,t])=>C(t,r))?.[0]||"UNKNOWN"}function a(r){return r!=null}}function M(n){let e="{{SummonGrid",s=-1;for(let[a,r]of n.summons.entries()){let o=a==0?"main":"s"+a,t=a==0?"umain":"u"+a,i=a==0?"main":a,u=R(r);e+=`\n|`+o+"="+r.name,e+="|"+t+"="+N(r),e+=u?`|art${i}=${u}`:"",r.qs&&(s=a)}for(let[a,r]of n.sub_summons.entries()){let o=a+1,t=`sub${o}`,i=`usub${o}`,u=R(r);e+=`\n|`+t+"="+r.name,e+="|"+i+"="+N(r),e+=u?`|art${o}=${u}`:""}return s>-1&&(e+=`\n|quick=`+(s==0?"main":s)),e+=`\n}}`,e}var Z=["0mlb","1mlb","2mlb","mlb","flb","ulb","trans"];function N(n){let e=n.uncap,s=Z[e];return n.transcend&&(s+=n.transcend),s}var P={"Colossus Omega":4,"Leviathan Omega":4,"Yggdrasil Omega":4,"Tiamat Omega":4,"Luminiera Omega":4,"Celeste Omega":4,Agni:5,Varuna:5,Titan:5,Zephyrus:5,Zeus:5,Hades:5};function R(n){return n.transcend?n.transcend==5?"D":"C":n.name in P&&n.uncap>=P[n.name]?"B":""}k().then(n=>{if(n)if(location.hostname.endsWith("game.granbluefantasy.jp")){let e=h($(x()));e&&(I(e),alert("Copied team data to clipboard!"))}else alert("Can only be used in game.granbluefantasy.jp")});})();